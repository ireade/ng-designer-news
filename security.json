{
    "rules": {
      
        ".read": true,
        
        "stories": {      
          "$story_id": {
            
            
            "title": {
              ".write": "!data.exists()
                         && auth !== null",
              ".validate": "newData.isString()"
            },
            "date": {
              ".write": "!data.exists()
                         && auth !== null",
              ".validate": "newData.val() <= now"
            },
            "url": {
              ".write": "!data.exists()
                         && auth !== null"
            },
            "description": {
              ".write": "!data.exists()
                         && auth !== null",
              ".validate": "newData.isString()"
            },
            
            
            "user": {
              ".write": "!data.exists()
                         && auth !== null
                         && newData.hasChildren(['first_name', 'last_name', 'id', 'title'])"
            },
            
            
            "voteCount": {
              ".write": "auth !== null
                         && newData.val() === data.val() + 1
                         && auth.uid !== root.child('stories').child($story_id).child('user').child('id').val()"
            },
            "voters": {
              ".write": "auth !== null"
            },
            
            "commentCount": {
              ".write": "auth !== null
                         && newData.val() === data.val() + 1"
            },
            
            "comments": {
              "$comment_id": {
                ".write": true
              }
            }
            
          }
        },
        
        "users": {
          "$user_id": {
            
            
            "karma": {
              ".write": "auth !== null
                         && newData.val() === data.val() + 1
                         && auth.uid !== $user_id"
              
            },
            
            "posts": {
              ".write": true
            },
            "comments": {
              ".write": true
            }
          }
        }
    }
}